/*! ui-lib - v0.0.1 - 2014-12-03
* Copyright (c) 2014 */
function Class(){}Class.extend=function a(b){var c=new this,d=this.prototype;for(var e in b)c[e]="function"==typeof b[e]&&"function"==typeof d[e]?function(a,b){return function(){var c=this.callSuper;this.callSuper=a;var d=b.apply(this,arguments);return this.callSuper=c,this.callSuper||delete this.callSuper,d}}(d[e],b[e]):b[e];var f=function(){};return f.prototype=c,f.prototype.constructor=f,f.extend=a,f.create=f.prototype.create=function(){var a=new this;return a.init&&a.init.apply(a,arguments),a},f},jQuery.autocomplete=function(a,b){function c(){D={},D.data={},D.length=0}function d(){if(46==F||F>8&&32>F)return z.hide();var a=x.val();a!=B&&(B=a,a.length>=b.minChars?(x.addClass(b.loadingClass),p(a)):(x.removeClass(b.loadingClass),z.hide()))}function e(a){var b=$("li",y);b&&(C+=a,0>C?C=0:C>=b.size()&&(C=b.size()-1),b.removeClass("ac_over"),$(b[C]).addClass("ac_over"))}function f(){var a=$("li.ac_over",y)[0];if(!a){var c=$("li",y);b.selectOnly?1==c.length&&(a=c[0]):b.selectFirst&&(a=c[0])}return a?(g(a),!0):!1}function g(c){c||(c=document.createElement("li"),c.extra=[],c.selectValue="");var d=$.trim(c.selectValue?c.selectValue:c.innerHTML);a.lastSelected=d,B=d,z.html(""),x.val(d),l(),b.onItemSelect&&setTimeout(function(){b.onItemSelect(c)},1)}function h(a,b){var c=x.get(0);if(c.createTextRange){var d=c.createTextRange();d.collapse(!0),d.moveStart("character",a),d.moveEnd("character",b),d.select()}else c.setSelectionRange?c.setSelectionRange(a,b):c.selectionStart&&(c.selectionStart=a,c.selectionEnd=b);c.focus()}function i(a){8!=F&&(x.val(x.val()+a.substring(B.length)),h(B.length,a.length))}function j(){var c=v(a),d=b.width>0?b.width:x.width();z.css({width:parseInt(d)+"px",top:c.y+a.offsetHeight+"px",left:c.x+"px"}),z.show()}function k(){A&&clearTimeout(A),A=setTimeout(l,200)}function l(){if(A&&clearTimeout(A),x.removeClass(b.loadingClass),z.is(":visible")&&z.hide(),b.mustMatch){var c=x.val();c!=a.lastSelected&&g(null)}}function m(a,c){if(c){if(x.removeClass(b.loadingClass),y.innerHTML="",!E||0==c.length)return l();y.appendChild(o(c)),b.autoFill&&x.val().toLowerCase()==a.toLowerCase()&&i(c[0][0]),j()}else l()}function n(a){if(!a)return null;for(var c=[],d=a.split(b.lineSeparator),e=0;e<d.length;e++){var f=$.trim(d[e]);f&&(c[c.length]=f.split(b.cellSeparator))}return c}function o(a){var c=document.createElement("ul"),d=a.length;b.maxItemsToShow>0&&b.maxItemsToShow<d&&(d=b.maxItemsToShow);for(var e=0;d>e;e++){var f=a[e];if(f){var h=document.createElement("li");b.formatItem?(h.innerHTML=b.formatItem(f,e,d),h.selectValue=f[0]):(h.innerHTML=f[0],h.selectValue=f[0]);var i=null;if(f.length>1){i=[];for(var j=1;j<f.length;j++)i[i.length]=f[j]}h.extra=i,c.appendChild(h),$(h).hover(function(){$("li",c).removeClass("ac_over"),$(this).addClass("ac_over"),C=$("li",c).indexOf($(this).get(0))},function(){$(this).removeClass("ac_over")}).click(function(a){a.preventDefault(),a.stopPropagation(),g(this)})}}return c}function p(a){b.matchCase||(a=a.toLowerCase());var c=b.cacheLength?r(a):null;c?m(a,c):"string"==typeof b.url&&b.url.length>0?$.get(q(a),function(b){b=n(b),u(a,b),m(a,b)}):x.removeClass(b.loadingClass)}function q(a){var c=b.url+"?q="+encodeURI(a);for(var d in b.extraParams)c+="&"+d+"="+encodeURI(b.extraParams[d]);return c}function r(a){if(!a)return null;if(D.data[a])return D.data[a];if(b.matchSubset)for(var c=a.length-1;c>=b.minChars;c--){var d=a.substr(0,c),e=D.data[d];if(e){for(var f=[],g=0;g<e.length;g++){var h=e[g],i=h[0];s(i,a)&&(f[f.length]=h)}return f}}return null}function s(a,c){b.matchCase||(a=a.toLowerCase());var d=a.indexOf(c);return-1==d?!1:0==d||b.matchContains}function t(a,c){c&&x.removeClass(b.loadingClass);for(var d=c?c.length:0,e=null,f=0;d>f;f++){var g=c[f];if(g[0].toLowerCase()==a.toLowerCase()){e=document.createElement("li"),b.formatItem?(e.innerHTML=b.formatItem(g,f,d),e.selectValue=g[0]):(e.innerHTML=g[0],e.selectValue=g[0]);var h=null;if(g.length>1){h=[];for(var i=1;i<g.length;i++)h[h.length]=g[i]}e.extra=h}}b.onFindValue&&setTimeout(function(){b.onFindValue(e)},1)}function u(a,d){d&&a&&b.cacheLength&&(!D.length||D.length>b.cacheLength?(c(),D.length++):D[a]||D.length++,D.data[a]=d)}function v(a){for(var b=$(a).position().left+(document.defaultView.getComputedStyle(a,null).marginLeft?parseInt(document.defaultView.getComputedStyle(a,null).marginLeft):0)||0,c=$(a).position().top||0;a=a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop;return{x:b,y:c}}var w=this,x=$(a).attr("autocomplete","off");b.inputClass&&x.addClass(b.inputClass);var y=document.createElement("div"),z=$(y);z.hide().addClass(b.resultsClass).css("position","absolute"),b.width>0&&z.css("width",b.width),$("body").append(y),a.autocompleter=w;var A=null,B="",C=-1,D={},E=!1,F=null;if(c(),null!=b.data){var G="",H={},I=[];"string"!=typeof b.url&&(b.cacheLength=1);for(var J=0;J<b.data.length;J++)I="string"==typeof b.data[J]?[b.data[J]]:b.data[J],I[0].length>0&&(G=I[0].substring(0,1).toLowerCase(),H[G]||(H[G]=[]),H[G].push(I));for(var K in H)b.cacheLength++,u(K,H[K])}x.keydown(function(a){switch(F=a.keyCode,a.keyCode){case 38:a.preventDefault(),e(-1);break;case 40:a.preventDefault(),e(1);break;case 9:case 13:f()&&(x.get(0).blur(),a.preventDefault());break;default:C=-1,A&&clearTimeout(A),A=setTimeout(function(){d()},b.delay)}}).focus(function(){E=!0}).blur(function(){E=!1,k()}),l(),this.flushCache=function(){c()},this.setExtraParams=function(a){b.extraParams=a},this.findValue=function(){var a=x.val();b.matchCase||(a=a.toLowerCase());var c=b.cacheLength?r(a):null;c?t(a,c):"string"==typeof b.url&&b.url.length>0?$.get(q(a),function(b){b=n(b),u(a,b),t(a,b)}):t(a,null)}},jQuery.fn.autocomplete=function(a,b,c){return b=b||{},b.url=a,b.data="object"==typeof c&&c.constructor==Array?c:null,b.inputClass=b.inputClass||"ac_input",b.resultsClass=b.resultsClass||"ac_results",b.lineSeparator=b.lineSeparator||"\n",b.cellSeparator=b.cellSeparator||"|",b.minChars=b.minChars||1,b.delay=b.delay||400,b.matchCase=b.matchCase||0,b.matchSubset=b.matchSubset||1,b.matchContains=b.matchContains||0,b.cacheLength=b.cacheLength||1,b.mustMatch=b.mustMatch||0,b.extraParams=b.extraParams||{},b.loadingClass=b.loadingClass||"ac_loading",b.selectFirst=b.selectFirst||!1,b.selectOnly=b.selectOnly||!1,b.maxItemsToShow=b.maxItemsToShow||-1,b.autoFill=b.autoFill||!1,b.width=parseInt(b.width,10)||0,this.each(function(){var a=this;new jQuery.autocomplete(a,b)}),this},jQuery.fn.autocompleteArray=function(a,b){return this.autocomplete(null,b,a)},jQuery.fn.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1};var AutoComplete=Class.extend({init:function(a,b,c){a.autocomplete(null,c,b)}}),ContextMenu=Class.extend({init:function(a){this._options={fadeSpeed:100,filter:function(){},above:"auto",preventDoubleContext:!0,compress:!1},this._menus=[];for(var b in a)this._options[b]=a[b];var c=this;$(document).on("mouseup","html",function(a){a.preventDefault(),1==a.which&&c.hide()}),this._options.preventDoubleContext&&$(document).on("contextmenu",".dropdown-context",function(a){a.preventDefault()}),$(document).on("mouseenter",".dropdown-submenu",function(){var a=$(this).find(".dropdown-context-sub:first"),b=a.width(),c=a.offset().left,d=b+c>window.innerWidth;d&&a.addClass("drop-left")})},getMenuByHeader:function(a){return this._menus["dropdown-"+a]},addItem:function(a,b,c){var d="";if("undefined"!=typeof b.divider)"undefined"!=typeof c?c.after('<li class="divider"></li>'):a.append('<li class="divider"></li>');else if("undefined"!=typeof b.header)"undefined"!=typeof c?c.after('<li class="nav-header">'+b.header+"</li>"):a.append('<li class="nav-header">'+b.header+"</li>");else{if("undefined"==typeof b.href&&(b.href="#"),"undefined"!=typeof b.target&&(d=' target="'+b.target+'"'),$sub="undefined"!=typeof b.subMenu?"undefined"!=typeof b.icon?'<li class="dropdown-submenu active"><a class="width-icon" tabindex="-1" href="'+b.href+"\"><i class= '"+b.icon+"'></i><span>  </span>"+b.text+"</a></li>":'<li class="dropdown-submenu active"><a class="widthout-icon" tabindex="-1" href="'+b.href+'">'+b.text+"</a></li>":$("undefined"!=typeof b.icon?'<li class="active"><a class="width-icon" tabindex="-1" href="'+b.href+'"'+d+"><i class= '"+b.icon+"'></i><span>  </span>"+b.text+"</a></li>":'<li class="active"><a class="widthout-icon" tabindex="-1" href="'+b.href+'"'+d+">"+b.text+"</a></li>"),"undefined"!=typeof b.action){var e=new Date,f="event-"+e.getTime()*Math.floor(1e5*Math.random()),g=b.action;$sub.find("a").attr("id",f),$("#"+f).addClass("context-event"),$(document).on("mousedown","#"+f,function(a){a.preventDefault(),a.stopPropagation()}).on("mouseup","#"+f,g).on("click","#"+f,function(a){a.preventDefault(),a.stopPropagation()})}if("undefined"!=typeof c?c.after($sub):a.append($sub),"undefined"!=typeof b.subMenu){var h=this.addCtxMenu(b.subMenu,!0);"undefined"!=typeof c?c.next().append(h):a.find("li:last").append(h)}}"function"==typeof this._options.filter&&"undefined"!=typeof c&&this._options.filter(a.find("li:last"))},addCtxMenu:function(a,b){var c="dropdown-"+a[0].header;if("undefined"!=typeof this._menus[c])return void console.log("the menu of this header already existed!");var d="",e=this._options.compress?" compressed-context":"";b?d=" dropdown-context-sub":$(".dropdown-context").fadeOut(this._options.fadeSpeed,function(){$(".dropdown-context").css({display:""}).find(".drop-left").removeClass("drop-left")});for(var f=$('<ul class="dropdown-menu dropdown-context'+d+e+'" id="'+c+'"></ul>'),g=0;g<a.length;++g)this.addItem(f,a[g]);return $("body").append(f),this._menus[c]=f,f},removeMenuByHeader:function(a){this._menus["dropdown-"+a].remove(),delete this._menus["dropdown-"+a]},getItemByText:function(a,b){for(var c=a.children("li"),d=0;d<c.length;d++)if(c[d].textContent.replace("  ","")===b)return $(c[d]);return void 0},removeItem:function(a){a.remove()},hasItem:function(a,b){for(var c=a.children("li"),d=0;d<c.length;d++)if(c[d].textContent===b.text)return!0;return!1},show:function(a,b,c){$(".dropdown-context:not(.dropdown-context-sub)").hide(),a.css({top:c,left:b}).fadeIn(this._options.fadeSpeed)},hide:function(){$(".dropdown-context").fadeOut(this._options.fadeSpeed,function(){$(".dropdown-context").css({display:""}).find(".drop-left").removeClass("drop-left")})},attachToMenu:function(a,b,c){var d=this;$(document).on("contextmenu",a,function(e){e.preventDefault(),e.stopPropagation(),console.log("selector: "+a),"HTML"!==e.target.tagName&&"function"==typeof c&&c(a.replace("#",""),b);var f=b.width(),g=b.height();left_=document.body.clientWidth<e.clientX+f?e.clientX-f:e.clientX,top_=$(document).height()<e.clientY+g+25?e.clientY-g-10:e.clientY,d.show(b,left_,top_)})},detachFromMenu:function(a){$(document).off("contextmenu",a)},activeItem:function(a,b,c){var d=this.getItemByText(this.getMenuByHeader(a),b);if("undefined"!=typeof d){d.removeClass("disabled"),d.addClass("active");var e=$(d).children("a")[0].id;"undefined"==typeof e&&""===e||"undefined"==typeof c||($("#"+e).addClass("context-event"),$(document).off("mouseup","#"+e),$(document).on("mouseup","#"+e,c))}},disableItem:function(a,b){var c=this.getItemByText(this.getMenuByHeader(a),b);if("undefined"!=typeof c){c.removeClass("active"),c.addClass("disabled");var d=$(c).children("a")[0].id;$("#"+d).removeClass("context-event"),$(document).off("mouseup","#"+d),$(document).on("mouseup","#"+d,function(a){a.preventDefault()})}},isDisabledItem:function(a,b){var c=this.getItemByText(this.getMenuByHeader(a),b);return"undefined"==typeof c?null:c.hasClass("disabled")}}),Gauge=Class.extend({init:function(a){this._defaultOptions={width:400,height:30,reflex:.5,opacity:.25,pulse:100,limit:!1,noscale:!1,gradient:!1,vertical:!1,busy:!1,radius:1,scale:null,empty:"#cccccc",name:null,values:null,colors:["#3765d9","#9ede7c","#9e42ee","#ec7612","#00aaaa","#cc0000","#aaaa00","#008000"]},this.setOptions(this._defaultOptions,a)},setOptions:function(a,b){if(b)for(var c in b)a[c]=b[c]},add:function(a,b){var c=this,d={};c.setOptions(d,c._defaultOptions),c.setOptions(d,b);var f=d.vertical,g=Math.max(d.width,f?8:48),h=Math.max(d.height,f?48:12);!f&&3*h>g&&(g=3*h),f&&3*g>h&&(h=3*g);var i=null!==d.name?d.name:a[0].id+"_gauge";if(!document.getElementById(i)){if(document.all&&document.namespaces&&!window.opera&&(!document.documentMode||document.documentMode<9)){if(null==document.namespaces.v){for(var j=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","roundrect","oval","rect","arc","image"],k=document.createStyleSheet(),l=0;l<j.length;l++)k.addRule("v\\:"+e[l],"behavior: url(#default#VML);");document.namespaces.add("v","urn:schemas-microsoft-com:vml")}var m="block"===a.currentStyle.display.toLowerCase()?"block":"inline-block",n=document.createElement(['<var style="zoom:1;display:'+m+";width:"+g+"px;height:"+h+'px;padding:0px;margin:0px;">'].join("")),o=object.currentStyle.styleFloat.toLowerCase();n._dpl="left"==o||"right"==flt?"inline":"inline-block"}else{var n=document.createElement("canvas");n.wk4=-1==navigator.appVersion.indexOf("WebKit")||document.defaultCharset?0:1,n.ge8=navigator.userAgent.indexOf("Gecko")>-1&&window.updateCommands&&!window.external?1:0}(n||n.getContext("2d"))&&(n.options=d,n.id=i,n.style.padding="0px",n.style.margin="0px",n.style.border="none",n.style.width=g+"px",n.style.height=h+"px",n.width=g,n.height=h,a.innerHTML="",a.append(n),c.modify(n,d))}},modify:function(a,b){function c(a){function b(a){return Math.max(0,Math.min(parseInt(a,16),255))}return b(a.substr(1,2))+","+b(a.substr(3,2))+","+b(a.substr(5,2))}function d(b){var c=a.cl.concat(h.colors),d=c.length-1,e=b;return e>d&&(e=b%d-1),c[e]}function e(a,b,c,d){function e(a){return Math.max(0,Math.min(parseInt(a,16),255))}function f(a){return a=Math.round(Math.min(Math.max(0,a),255)),"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16)}var g,h,i,j,k,l=1-c;return j=e(a.substr(1,2)),k=e(b.substr(1,2)),g=Math.max(0,Math.min(255,parseInt(j*l+k*c))),j=e(a.substr(3,2)),k=e(b.substr(3,2)),h=Math.max(0,Math.min(255,parseInt(j*l+k*c))),j=e(a.substr(5,2)),k=e(b.substr(5,2)),i=Math.max(0,Math.min(255,parseInt(j*l+k*c))),d?g+","+h+","+i:"#"+f(g)+f(h)+f(i)}function f(b,c,d,e){a.wk4?(a.ctx.beginPath(),a.ctx.rect(b,c,d,e),a.ctx.closePath(),a.ctx.fill()):a.ctx.fillRect(b,c,d,e)}function g(b){if(a.ctx.clearRect(0,0,a.width,a.height),k=a.ctx.createLinearGradient(0,0,x?A:0,x?0:z),k.addColorStop(0,"rgba(255,255,255,0.75)"),k.addColorStop(.05,"rgba(255,255,255,0.5)"),k.addColorStop(.5,"rgba(127,127,127,0.4)"),k.addColorStop(.95,"rgba(0,0,0,0.55)"),k.addColorStop(1,"rgba(0,0,0,"+(x?.66:.8)+")"),a.ctx.lineWidth=.25,a.ctx.lineCap="butt",a.ctx.save(),a.ctx.beginPath(),a.ctx.moveTo(0,z-j),a.ctx.quadraticCurveTo(0,z,j,z),a.ctx.quadraticCurveTo(0,z,0,z+j),a.ctx.lineTo(0,z+y),a.ctx.lineTo(A,z+y),a.ctx.lineTo(A,z+j),a.ctx.quadraticCurveTo(A,z,A-j,z),a.ctx.quadraticCurveTo(A,z,A,z-j),a.ctx.lineTo(A,j),a.ctx.quadraticCurveTo(A,0,A-j,0),a.ctx.lineTo(j,0),a.ctx.quadraticCurveTo(0,0,0,j),a.ctx.closePath(),a.ctx.clip(),a.ge8&&(a.ctx.fillStyle="rgba(0,0,0,0)",a.ctx.fillRect(0,0,a.width,a.height)),a.bu)n=e(d(0),d(1),b/10,!0),a.ctx.fillStyle="rgba("+n+",1)",f(0,0,a.width,a.height);else if(a.vl){for(p=a.vl.length-(a.lv&&a.vl.length>=2?1:0),i=0;p>i;i++)s+=Math.abs(a.vl[i]);if(s=Math.max(s,Math.abs(a.vl[a.vl.length-1])),a.lv&&a.gr&&1==p)t=(x?z:A)*(Math.abs(a.vl[0])/s),n=d(0),o=d(1),l=a.ctx.createLinearGradient(0,0,x?0:A,x?z:0),l.addColorStop(x?1:0,"rgba("+c(n)+",1)"),l.addColorStop(x?0:1,"rgba("+c(o)+",1)"),w+=u,v=z-t,u=t,a.ctx.fillStyle=l,x?f(0,v,A,t):f(w,0,t,a.height);else if(x)for(v=z,i=0;p>i;i++)l=d(i),t=z*(Math.abs(a.vl[i])/s),v-=t,u=t,a.ctx.fillStyle=l,f(0,v,A,t);else for(i=0;p>i;i++)l=d(i),t=A*(Math.abs(a.vl[i])/s),w+=u,u=t,a.ctx.fillStyle=l,f(w,0,t,a.height);(x&&v>.25||!x&&A>w+t)&&(w+=u,t=A-w,a.ctx.fillStyle="rgba("+a.dc+","+(window.opera?1:a.op)+")",x?f(0,0,A,v):f(w,0,t,a.height)),x&&(a.ctx.fillStyle="rgba("+(a.lv&&Math.abs(a.vl[0])<=0?a.dc:c(d(0)))+","+(window.opera?1:a.op)+")",f(0,z,A,A))}else a.ctx.fillStyle="rgba("+a.dc+","+(window.opera?1:a.op)+")",f(0,0,a.width,a.height);if(a.ctx.fillStyle=k,f(0,0,A,z),!a.ns)if(k=a.ctx.createLinearGradient(x?.5:0,x?0:.5,x?A:0,x?0:z),k.addColorStop(0,"rgba(254,254,254,1)"),k.addColorStop(.66,"rgba(254,254,254,0.8)"),k.addColorStop(1,"rgba(254,254,254,0)"),x)for(i=0;C>i;i++)a.ctx.beginPath(),a.ctx.moveTo(.5,z-(B+i*B+.5)),a.ctx.lineTo(A,z-(B+i*B+.5)),a.ctx.strokeStyle="rgba(0,0,0,0.75)",a.ctx.stroke(),a.ctx.beginPath(),a.ctx.moveTo(.5,z-(B+i*B)),a.ctx.lineTo(A,z-(B+i*B)),a.ctx.strokeStyle=k,a.ctx.stroke();else for(i=0;C>i;i++)a.ctx.beginPath(),a.ctx.moveTo(B+i*B,.5),a.ctx.lineTo(B+i*B,z+(window.opera?0:y)),a.ctx.strokeStyle="rgba(0,0,0,0.75)",a.ctx.stroke(),a.ctx.beginPath(),a.ctx.moveTo(B+i*B+.5,.5),a.ctx.lineTo(B+i*B+.5,z),a.ctx.strokeStyle=k,a.ctx.stroke();k=a.ctx.createLinearGradient(0,z,0,z+y),k.addColorStop(0,"rgba(0,0,0,1)"),k.addColorStop(.1,"rgba(0,0,0,0.5)"),k.addColorStop(.5,"rgba(0,0,0,0)"),k.addColorStop(1,"rgba(0,0,0,0)"),a.ctx.fillStyle=k,f(0,z,A,z+y),a.ctx.globalCompositeOperation=window.opera?"xor":"destination-out",k=a.ctx.createLinearGradient(0,z,0,z+y),k.addColorStop(1,"rgba(0,0,0,1.0)"),k.addColorStop(0,"rgba(0,0,0,"+a.ty+")"),a.ctx.fillStyle=k,f(0,z,A,z+y),a.ctx.restore()}var h=a.options;if(a){var i,j,k,l,m,n,o,p,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=a.width<a.height?1:0,y=parseInt(x?a.width/2:a.height/3),z=x?a.height-y:2*y,A=a.width,B=parseInt(1.1*(x?A:z)),C=Math.round(((x?z:A)-2*y)/B);if(a.cc="string"==typeof b.empty?b.empty:a.options.empty,a.cc=a.cc.match(/^#[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i)?a.cc:h.empty,a.options.empty=a.cc,a.dc=c(a.cc),a.ty=Math.min(Math.max("number"==typeof b.reflex?b.reflex:a.options.reflex,.001),1),a.options.reflex=a.ty,a.op=Math.min(Math.max("number"==typeof b.opacity?b.opacity:a.options.opacity,.001),1),a.options.opacity=a.op,a.cr=Math.min(Math.max("number"==typeof b.radius?b.radius:a.options.radius,.001),1),a.options.radius=a.cr,a.pl=Math.min(Math.max("number"==typeof b.pulse?b.pulse:a.options.pulse,30),1e3),a.options.pulse=a.pl,a.cl="object"==typeof b.colors?b.colors:a.options.colors,a.options.colors=a.cl,a.vl="object"==typeof b.values?b.values:a.options.values,a.options.values=a.vl,a.gr="boolean"==typeof b.gradient?b.gradient:a.options.gradient,a.options.gradient=a.gr,a.lv="boolean"==typeof b.limit?b.limit:a.options.limit,a.options.limit=a.lv,a.ns="boolean"==typeof b.noscale?b.noscale:a.options.noscale,a.options.noscale=a.ns,a.vo=a.width<a.height?1:0,a.bu="boolean"==typeof b.busy?b.busy:a.options.busy,a.options.busy=a.bu,null!=b.scale&&(a.sn=Math.min(Math.max("number"==typeof b.scale?b.scale:a.options.scale,2),parseInt((x?z:A)/8)),a.options.scale=a.sn),null!=a.sn&&(B=parseInt((x?z:A)/a.sn),C=Math.round((x?z:A)/B)-1),j=parseInt(y*a.cr),a.timer&&window.clearInterval(a.timer),document.all&&document.namespaces&&!window.opera&&"VAR"==a.tagName.toUpperCase()&&(!document.documentMode||document.documentMode<9)){var D,E,F,G,H,I,J="",K="",r="m 0,0 l 0,"+parseInt(100*(y-j))+" qy "+parseInt(100*j)+","+parseInt(100*y)+" l "+parseInt(100*(A-j))+","+parseInt(100*y)+" qx "+parseInt(100*A)+","+parseInt(100*(y-j))+" l "+parseInt(100*A)+",0 x e";if(D='<v:group style="zoom:1;display:'+a.dpl+";margin:0px;padding:0px;position:relative;width:"+a.width+"px;height:"+a.height+'px;" coordsize="'+a.width+","+a.height+'"><v:rect filled="f" stroked="f" strokeweight="0" style="zoom:1;display:block;position:absolute;top:0px;left:0px;margin:0px;padding:0px;width:'+a.width+"px;height:"+a.height+'px;"></v:rect>',E="</v:group>",F='<v:roundrect id="'+(a.id+"_fyll")+'" arcsize="'+.5*a.cr+'" style="width:'+A+"px;height:"+z+'px;left:0px;top:0px;position:absolute;display:block;margin:0px;padding:0px;" filled="f" stroked="f" strokeweight="0">',G='<v:shape id="'+(a.id+"_flex")+'" coordorigin="0,0" coordsize="'+100*A+","+100*y+'" path="'+r+'" style="filter:Alpha(opacity='+(100-100*a.ty)+",finishOpacity=0,startX=0,finishX=0,startY=0,finishY=100,style=1); width:"+A+"px;height:"+y+"px;left:0px;top:"+z+'px;position:absolute;display:block;margin:0px;padding:0px;rotation:180;" filled="f" stroked="f" strokeweight="0">',x?(r="m "+parseInt(100*y)+",0 l "+parseInt(100*j)+",0 qx 0,"+parseInt(100*j)+" l 0,"+parseInt(100*(z-j))+" qy "+parseInt(100*j)+","+parseInt(100*z)+" l "+parseInt(100*y)+","+parseInt(100*z)+" x e",H='<v:shape print="false" coordorigin="0,0" coordsize="'+100*y+","+100*z+'" path="'+r+'" style="width:'+y+"px;height:"+z+'px;left:0px;top:0px;position:absolute;display:block;margin:0px;padding:0px;rotation:0;" filled="t" stroked="f" strokeweight="0"><v:fill color="white" opacity="0.5" color2="white" o:opacity2="0.0" type="gradient" method="linear" angle="270" /></v:shape>',I='<v:shape print="false" coordorigin="0,0" coordsize="'+100*y+","+100*z+'" path="'+r+'" style="width:'+y+"px;height:"+z+"px;left:"+y+'px;top:0px;position:absolute;display:block;margin:0px;padding:0px;rotation:180;" filled="t" stroked="f" strokeweight="0"><v:fill color="black" opacity="0.33" color2="black" o:opacity2="0.0" type="gradient" method="sigma" angle="90" /></v:shape>'):(H='<v:shape print="false" coordorigin="0,0" coordsize="'+100*A+","+100*y+'" path="'+r+'" style="width:'+A+"px;height:"+y+'px;left:0px;top:0px;position:absolute;display:block;margin:0px;padding:0px;rotation:180;" filled="t" stroked="f" strokeweight="0"><v:fill color="white" opacity="0.5" color2="white" o:opacity2="0.0" type="gradient" method="linear" angle="180" /></v:shape>',I='<v:shape print="false" coordorigin="0,0" coordsize="'+100*A+","+100*y+'" path="'+r+'" style="width:'+A+"px;height:"+y+"px;left:0px;top:"+y+'px;position:absolute;display:block;margin:0px;padding:0px;rotation:0;" filled="t" stroked="f" strokeweight="0"><v:fill color="black" opacity="0.33" color2="black" o:opacity2="0.0" type="gradient" method="sigma" angle="0" /></v:shape>'),a.vl&&!a.bu){for(p=a.vl.length-(a.lv&&a.vl.length>=2?1:0),i=0;p>i;i++)s+=Math.abs(a.vl[i]);if(s=Math.max(s,Math.abs(a.vl[a.vl.length-1])),n=d(0),o=d(p-1),u=0,m="",a.lv&&a.gr&&1==p)o=a.cc,l=d(1),t=100*(Math.abs(a.vl[0])/s),l=e(n,l,t/100),m="0% "+n+", "+t+"% "+l+", "+t+"% "+o;else for(i=0;p>i;i++)l=d(i),t=100*(Math.abs(a.vl[i])/s),0==i&&i==p-1&&a.lv?(o=a.cc,m+=t+"% "+l+", "+t+"% "+o):0==i?m+=t+"% "+l+", ":i==p-1&&a.lv?(o=a.cc,m+=u+"% "+l+", "+(u+t)+"% "+l+", "+(u+t)+"% "+o):m+=i==p-1?u+"% "+l:u+"% "+l+", "+(u+t)+"% "+l+", ",u+=t;F+='<v:fill color="'+n+'" color2="'+o+'" type="gradient" colors="'+m+'" method="linear" angle="'+(x?0:270)+'" on="t" /></v:roundrect>',G+=x?'<v:fill color="'+(a.lv&&Math.abs(a.vl[0])<=0?a.cc:d(0))+'" on="t" /></v:shape>':'<v:fill color="'+n+'" color2="'+o+'" type="gradient" colors="'+m+'" method="linear" angle="'+(x?0:270)+'" on="t" /></v:shape>'}else l=a.bu?d(0):a.cc,F+='<v:fill color="'+l+'" on="t" /></v:roundrect>',G+='<v:fill color="'+l+'" on="t" /></v:shape>';if(!a.ns){if(n="",o="",x)for(i=0;C>i;i++)n+=" m 100,"+parseInt(100*z-100*B-100*i*B+100)+" l "+parseInt(100*A-100)+","+parseInt(100*z-100*B-100*i*B+100)+" e",o+=" m 100,"+parseInt(100*z-100*B-100*i*B)+" l "+parseInt(100*A-100)+","+parseInt(100*z-100*B-100*i*B)+" e";else for(i=0;C>i;i++)n+=" m "+parseInt(100*B+100*i*B+100)+",100 l "+parseInt(100*B+100*i*B+100)+","+parseInt(100*z-100)+" e",o+=" m "+parseInt(100*B+100*i*B)+",100 l "+parseInt(100*B+100*i*B)+","+parseInt(100*z-100)+" e";J='<v:shape coordorigin="0,0" coordsize="'+100*A+","+100*z+'" path="'+n+'" style="width:'+A+"px;height:"+z+'px;left:0px;top:0px;position:absolute;display:block;margin:0px;padding:0px;" filled="f" stroked="t"><v:stroke color="white" opacity="0.33" weight="0.1pt" miterlimit="0" endcap="round" /></v:shape>',K='<v:shape coordorigin="0,0" coordsize="'+100*A+","+100*z+'" path="'+o+'" style="width:'+A+"px;height:"+z+'px;left:0px;top:0px;position:absolute;display:block;margin:0px;padding:0px;" filled="f" stroked="t"><v:stroke color="black" opacity="0.2" weight="0.1pt" miterlimit="0" endcap="round" /></v:shape>'}a.innerHTML=D+G+F+J+K+H+I+E,a.bu&&(n=document.getElementById(a.id+"_flex").firstChild,o=document.getElementById(a.id+"_fyll").firstChild,r=0,q=0,a.timer=window.setInterval(function(){l=e(d(0),d(1),r/10),n.color=l,o.color=l,1==q?r--:r++,r>10&&0==q&&(r--,q=1),0>r&&1==q&&(r++,q=0)},a.pl))}else"CANVAS"==a.tagName.toUpperCase()&&a.getContext("2d")&&(a.ctx=a.getContext("2d"),a.bu?(r=0,q=0,a.timer=window.setInterval(function(){g(r),1==q?r--:r++,r>10&&0==q&&(r--,q=1),0>r&&1==q&&(r++,q=0)},a.pl)):g())}return!1}}),Inputer=Class.extend({init:function(a){if("undefined"==typeof a)throw"Desktop Inputer need a name!!";this._options={left:"0",top:"0",width:"100",height:"32"},this._name=a,_this=this,this.$input=$("<textarea>",{name:a}).css({"z-index":"9999",display:"none",position:"absolute","font-size":"small","white-space":"pre","-webkit-user-select":"none","-moz-user-select":"none",resize:"none","overflow-y":"hidden"}),$("body").append(this.$input),_this.bindEvent(_this)},bindEvent:function(a){var b=a;$(document).on("mousedown","html",function(){b.hide()}).on("contextmenu","html",function(){b.hide()}).on("mousedown","[name="+b._name+"]",function(a){b.$input[0].focus(),b.$input[0].select(),a.stopPropagation()}),window.addEventListener("blur",function(){b.hide()},!1),b.$input.keyup(function(a){13==a.which&&("\n"==b.$input.val()?b.$input.hide():b.hide()),27==a.which&&b.$input.hide(),a.stopPropagation()}).keydown(function(a){a.stopPropagation()})},show:function(a){if("function"!=typeof a.callback)throw"bad type of callback";for(var b in a)this._options[b]=a[b];this.$input.css({left:this._options.left,top:this._options.top,width:this._options.width,height:this._options.height}),this.$input.val(this._options.oldtext).show(),this.$input[0].focus(),this.$input[0].select()},hide:function(){this._options.callback&&this._options.callback.call(this,this.$input.val().replace(/\n/g,"")),this._options.callback=null,this.$input.hide()}}),ListView=Class.extend({init:function(a,b){if(this._options={width:"100%"},b)for(var c in b)this._options[c]=b[c];this._id=a,this._listview=$("<ul>",{id:this._id,"class":"listview"}),this._listview.css({width:this._options.width})},addItem:function(a,b){var c=$("<li>");if("undefined"!=typeof a.id&&c.attr("id",a.id),c.append("undefined"==typeof a.href||""===a.href?'<a href="#"></a>':'<a href="'+a.href+'"></a>'),"undefined"!=typeof a.img&&""!==a.img&&c.find("a").append('<img src="'+a.img+'" />'),c.find("a").append(a.text),"undefined"!=typeof a.clkaction){{var d=new Date,e="event"+d.getTime()*Math.floor(1e5*Math.random());a.clkaction}c.find("a").attr("id",e),$(document).on("click","#"+e,a.clkaction)}if("undefined"!=typeof a.dblclkaction){{var d=new Date,e="event"+d.getTime()*Math.floor(1e5*Math.random());a.dblclkaction}c.find("a").attr("id",e),$(document).on("dblclick","#"+e,a.dblclkaction)}"undefined"==typeof b?this._listview.append(c):b.append(c)},addSubItems:function(a){var b=$("<li>");if("undefined"!=typeof a.id&&b.attr("id",a.id),b.append('<a href="#" class ="sub" tabindex="1"></a>'),"undefined"!=typeof a.img&&""!==a.img&&b.find("a").append('<img src="'+a.img+'" />'),b.find("a").append(a.text),b.append('<img alt="" />'),"undefined"!=typeof a.subitems&&0!==a.subitems.length){for(var c=a.subitems.length,d=$("<ul>").css({width:this._options.width}),e=0;e!==c;e++)this.addItem(a.subitems[e],d);b.append(d)}else b.append($("<ul>"));this._listview.append(b)},addItems:function(a){for(var b=a.length,c=0;b>c;c++)switch(a[c].type){case"item":this.addItem(a[c]);break;case"subitems":this.addSubItems(a[c]);break;default:return void console.log("Error: unknown listview type")}},remove:function(a){$("#"+a).remove()},attach:function(a){$("#"+a).append(this._listview),this._listview.show()},isEmptyOfSubItems:function(a){var b=$("#"+a).find("ul").find("li").length;return 0===b?!0:!1}});!function(){var a,b=window.Messenger;a=window.Messenger=function(){return a._call.apply(this,arguments)},window.Messenger.noConflict=function(){return window.Messenger=b,a}}();var Messenge=Class.extend({init:function(){this.messenger=window.Messenger._call.apply(this,arguments)},post:function(){this.messenger.post(arguments[0])},run:function(){var a=arguments.length;switch(a){case 0:this.messenger.run();break;case 1:this.messenger.run(arguments[0]);break;case 2:this.messenger.run(arguments[0],arguments[1]);break;case 3:this.messenger.run(arguments[0],arguments[1],arguments[2])}},update:function(a){this.messenger.update(a)},cancel:function(){this.messenger.hide()},hide:function(){this.messenger.hide()},hideAll:function(){this.messenger.hideAll()},setOptions:function(a){window.Messenger.options=a}});window.Messenger._=function(){if(window._)return window._;var a=Array.prototype,b=Object.prototype,c=Function.prototype,d=(a.push,a.slice),e=(a.concat,b.toString),f=(b.hasOwnProperty,a.forEach),g=(a.map,a.reduce,a.reduceRight,a.filter),h=(a.every,a.some,a.indexOf,a.lastIndexOf,Array.isArray,Object.keys),i=c.bind,j={},k={},l=j.each=j.forEach=function(a,b,c){if(null!=a)if(f&&a.forEach===f)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(b.call(c,a[d],d,a)===k)return}else for(var g in a)if(j.has(a,g)&&b.call(c,a[g],g,a)===k)return};j.result=function(a,b){if(null==a)return null;var c=a[b];return j.isFunction(c)?c.call(a):c},j.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}};var m=0;return j.uniqueId=function(a){var b=++m+"";return a?a+b:b},j.filter=j.select=function(a,b,c){var d=[];return null==a?d:g&&a.filter===g?a.filter(b,c):(l(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},l(["Arguments","Function","String","Number","Date","RegExp"],function(a){j["is"+a]=function(b){return e.call(b)=="[object "+a+"]"}}),j.defaults=function(a){return l(d.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])}),a},j.extend=function(a){return l(d.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},j.keys=h||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)j.has(a,c)&&(b[b.length]=c);return b},j.bind=function(a,b){if(a.bind===i&&i)return i.apply(a,d.call(arguments,1));var c=d.call(arguments,2);return function(){return a.apply(b,c.concat(d.call(arguments)))}},j.isObject=function(a){return a===Object(a)},j}(),window.Messenger.Events=function(){if(window.Backbone&&Backbone.Events)return Backbone.Events;var a=function(){var a=/\s+/,b=function(b,c,d,e){if(!d)return!0;if("object"==typeof d)for(var f in d)b[c].apply(b,[f,d[f]].concat(e));else{if(!a.test(d))return!0;for(var g=d.split(a),h=0,i=g.length;i>h;h++)b[c].apply(b,[g[h]].concat(e))}},c=function(a,b){var c,d=-1,e=a.length;switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0]);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0],b[1]);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0],b[1],b[2]);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},d={on:function(a,c,d){if(!b(this,"on",a,[c,d])||!c)return this;this._events||(this._events={});var e=this._events[a]||(this._events[a]=[]);return e.push({callback:c,context:d,ctx:d||this}),this},once:function(a,c,d){if(!b(this,"once",a,[c,d])||!c)return this;var e=this,f=_.once(function(){e.off(a,f),c.apply(this,arguments)});return f._callback=c,this.on(a,f,d),this},off:function(a,c,d){var e,f,g,h,i,j,k,l;if(!this._events||!b(this,"off",a,[c,d]))return this;if(!a&&!c&&!d)return this._events={},this;for(h=a?[a]:_.keys(this._events),i=0,j=h.length;j>i;i++)if(a=h[i],e=this._events[a]){if(g=[],c||d)for(k=0,l=e.length;l>k;k++)f=e[k],(c&&c!==f.callback&&c!==f.callback._callback||d&&d!==f.context)&&g.push(f);this._events[a]=g}return this},trigger:function(a){if(!this._events)return this;var d=Array.prototype.slice.call(arguments,1);if(!b(this,"trigger",a,d))return this;var e=this._events[a],f=this._events.all;
return e&&c(e,d),f&&c(f,arguments),this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),e=a._listenerId||(a._listenerId=_.uniqueId("l"));return d[e]=a,a.on(b,"object"==typeof b?this:c,this),this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,"object"==typeof b?this:c,this),b||c||delete d[a._listenerId];else{"object"==typeof b&&(c=this);for(var e in d)d[e].off(b,c,this);this._listeners={}}return this}}};return d.bind=d.on,d.unbind=d.off,d};return a()}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},n=[].slice,o=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=jQuery,f=null!=(i=window._)?i:window.Messenger._,d=null!=(j="undefined"!=typeof Backbone&&null!==Backbone?Backbone.Events:void 0)?j:window.Messenger.Events,c=function(){function b(b){a.extend(this,d),f.isObject(b)&&(b.el&&this.setElement(b.el),this.model=b.model),this.initialize.apply(this,arguments)}return b.prototype.setElement=function(b){return this.$el=a(b),this.el=this.$el[0]},b.prototype.delegateEvents=function(a){var b,c,d,e,g,h,i;if(a||(a=f.result(this,"events"))){this.undelegateEvents(),b=/^(\S+)\s*(.*)$/,i=[];for(d in a){if(g=a[d],f.isFunction(g)||(g=this[a[d]]),!g)throw new Error('Method "'+a[d]+'" does not exist');e=d.match(b),c=e[1],h=e[2],g=f.bind(g,this),c+=".delegateEvents"+this.cid,i.push(""===h?this.jqon(c,g):this.jqon(c,h,g))}return i}},b.prototype.jqon=function(a,b,c){var d;return null!=this.$el.on?(d=this.$el).on.apply(d,arguments):(null==c&&(c=b,b=void 0),null!=b?this.$el.delegate(b,a,c):this.$el.bind(a,c))},b.prototype.jqoff=function(a){var b;return null!=this.$el.off?(b=this.$el).off.apply(b,arguments):(this.$el.undelegate(),this.$el.unbind(a))},b.prototype.undelegateEvents=function(){return this.jqoff(".delegateEvents"+this.cid)},b.prototype.remove=function(){return this.undelegateEvents(),this.$el.remove()},b}(),g=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return m(c,b),c.prototype.defaults={hideAfter:10,scroll:!0,closeButtonText:"&times;"},c.prototype.initialize=function(b){return null==b&&(b={}),this.shown=!1,this.rendered=!1,this.messenger=b.messenger,this.options=a.extend({},this.options,b,this.defaults)},c.prototype.show=function(){var a;return this.rendered||this.render(),this.$message.removeClass("messenger-hidden"),a=this.shown,this.shown=!0,a?void 0:this.trigger("show")},c.prototype.hide=function(){var a;if(this.rendered)return this.$message.addClass("messenger-hidden"),a=this.shown,this.shown=!1,a?this.trigger("hide"):void 0},c.prototype.cancel=function(){return this.hide()},c.prototype.update=function(b){var c,d=this;return f.isString(b)&&(b={message:b}),a.extend(this.options,b),this.lastUpdate=new Date,this.rendered=!1,this.events=null!=(c=this.options.events)?c:{},this.render(),this.actionsToEvents(),this.delegateEvents(),this.checkClickable(),this.options.hideAfter?(this.$message.addClass("messenger-will-hide-after"),null!=this._hideTimeout&&clearTimeout(this._hideTimeout),this._hideTimeout=setTimeout(function(){return d.hide()},1e3*this.options.hideAfter)):this.$message.removeClass("messenger-will-hide-after"),this.options.hideOnNavigate?(this.$message.addClass("messenger-will-hide-on-navigate"),null!=("undefined"!=typeof Backbone&&null!==Backbone?Backbone.history:void 0)&&Backbone.history.on("route",function(){return d.hide()})):this.$message.removeClass("messenger-will-hide-on-navigate"),this.trigger("update",this)},c.prototype.scrollTo=function(){return this.options.scroll?a.scrollTo(this.$el,{duration:400,offset:{left:0,top:-20}}):void 0},c.prototype.timeSinceUpdate=function(){return this.lastUpdate?new Date-this.lastUpdate:null},c.prototype.actionsToEvents=function(){var a,b,c,d,e=this;c=this.options.actions,d=[];for(b in c)a=c[b],d.push(this.events['click [data-action="'+b+'"] a']=function(a){return function(c){return c.preventDefault(),c.stopPropagation(),e.trigger("action:"+b,a,c),a.action.call(e,c,e)}}(a));return d},c.prototype.checkClickable=function(){var a,b,c,d;c=this.events,d=[];for(b in c)a=c[b],d.push("click"===b?this.$message.addClass("messenger-clickable"):void 0);return d},c.prototype.undelegateEvents=function(){var a;return c.__super__.undelegateEvents.apply(this,arguments),null!=(a=this.$message)?a.removeClass("messenger-clickable"):void 0},c.prototype.parseActions=function(){var b,c,d,e,f,g;c=[],f=this.options.actions;for(e in f)b=f[e],d=a.extend({},b),d.name=e,null==(g=d.label)&&(d.label=e),c.push(d);return c},c.prototype.template=function(b){var c,d,e,f,g,h,i,j,k,l,m=this;for(g=a("<div class='messenger-message message alert "+b.type+" message-"+b.type+" alert-"+b.type+"'>"),b.showCloseButton&&(e=a('<button type="button" class="messenger-close" data-dismiss="alert">'),e.html(b.closeButtonText),e.click(function(){return m.cancel(),!0}),g.append(e)),h=a('<div class="messenger-message-inner">'+b.message+"</div>"),g.append(h),b.actions.length&&(d=a('<div class="messenger-actions">')),l=b.actions,j=0,k=l.length;k>j;j++)i=l[j],c=a("<span>"),c.attr("data-action",""+i.name),f=a("<a>"),f.html(i.label),c.append(a('<span class="messenger-phrase">')),c.append(f),d.append(c);return g.append(d),g},c.prototype.render=function(){var b;if(!this.rendered)return this._hasSlot||(this.setElement(this.messenger._reserveMessageSlot(this)),this._hasSlot=!0),b=a.extend({},this.options,{actions:this.parseActions()}),this.$message=a(this.template(b)),this.$el.html(this.$message),this.shown=!0,this.rendered=!0,this.trigger("render")},c}(c),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this._timers={}},b.prototype.cancel=function(){return this.clearTimers(),this.hide(),null!=this._actionInstance&&null!=this._actionInstance.abort?this._actionInstance.abort():void 0},b.prototype.clearTimers=function(){var a,b,c,d;c=this._timers;for(a in c)b=c[a],clearTimeout(b);return this._timers={},null!=(d=this.$message)?d.removeClass("messenger-retry-soon messenger-retry-later"):void 0},b.prototype.render=function(){var a,c,d,e;b.__super__.render.apply(this,arguments),this.clearTimers(),d=this.options.actions,e=[];for(c in d)a=d[c],e.push(a.auto?this.startCountdown(c,a):void 0);return e},b.prototype.renderPhrase=function(a,b){var c;return c=a.phrase.replace("TIME",this.formatTime(b))},b.prototype.formatTime=function(a){var b;return b=function(a,b){return a=Math.floor(a),1!==a&&(b+="s"),"in "+a+" "+b},0===Math.floor(a)?"now...":60>a?b(a,"second"):(a/=60,60>a?b(a,"minute"):(a/=60,b(a,"hour")))},b.prototype.startCountdown=function(a,b){var c,d,e,f,g=this;if(null==this._timers[a])return c=this.$message.find("[data-action='"+a+"'] .messenger-phrase"),d=null!=(f=b.delay)?f:3,10>=d?(this.$message.removeClass("messenger-retry-later"),this.$message.addClass("messenger-retry-soon")):(this.$message.removeClass("messenger-retry-soon"),this.$message.addClass("messenger-retry-later")),(e=function(){var f;return c.text(g.renderPhrase(b,d)),d>0?(f=Math.min(d,1),d-=f,g._timers[a]=setTimeout(e,1e3*f)):(g.$message.removeClass("messenger-retry-soon messenger-retry-later"),delete g._timers[a],b.action())})()},b}(g),h=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return m(c,b),c.prototype.tagName="ul",c.prototype.className="messenger",c.prototype.messageDefaults={type:"info"},c.prototype.initialize=function(b){return this.options=null!=b?b:{},this.history=[],this.messageDefaults=a.extend({},this.messageDefaults,this.options.messageDefaults)},c.prototype.render=function(){return this.updateMessageSlotClasses()},c.prototype.findById=function(a){return f.filter(this.history,function(b){return b.msg.options.id===a})},c.prototype._reserveMessageSlot=function(b){var c,d,e=this;for(c=a("<li>"),c.addClass("messenger-message-slot"),this.$el.prepend(c),this.history.push({msg:b,$slot:c}),this._enforceIdConstraint(b),b.on("update",function(){return e._enforceIdConstraint(b)});this.options.maxMessages&&this.history.length>this.options.maxMessages;)d=this.history.shift(),d.msg.remove(),d.$slot.remove();return c},c.prototype._enforceIdConstraint=function(a){var b,c,d,e,f;if(null!=a.options.id)for(f=this.history,c=0,d=f.length;d>c;c++)if(b=f[c],e=b.msg,null!=e.options.id&&e.options.id===a.options.id&&a!==e){if(a.options.singleton)return void a.hide();e.hide()}},c.prototype.newMessage=function(a){var b,c,d,f,h=this;return null==a&&(a={}),a.messenger=this,g=null!=(c=null!=(d=Messenger.themes[null!=(f=a.theme)?f:this.options.theme])?d.Message:void 0)?c:e,b=new g(a),b.on("show",function(){return a.scrollTo&&"fixed"!==h.$el.css("position")?b.scrollTo():void 0}),b.on("hide show render",this.updateMessageSlotClasses,this),b},c.prototype.updateMessageSlotClasses=function(){var a,b,c,d,e,f,g;for(d=!0,b=null,a=!1,g=this.history,e=0,f=g.length;f>e;e++)c=g[e],c.$slot.removeClass("messenger-first messenger-last messenger-shown"),c.msg.shown&&c.msg.rendered&&(c.$slot.addClass("messenger-shown"),a=!0,b=c,d&&(d=!1,c.$slot.addClass("messenger-first")));return null!=b&&b.$slot.addClass("messenger-last"),this.$el[""+(a?"remove":"add")+"Class"]("messenger-empty")},c.prototype.hideAll=function(){var a,b,c,d,e;for(d=this.history,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.msg.hide());return e},c.prototype.post=function(b){var c;return f.isString(b)&&(b={message:b}),b=a.extend(!0,{},this.messageDefaults,b),c=this.newMessage(b),c.update(b),c},c}(c),b=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return m(c,b),c.prototype.doDefaults={progressMessage:null,successMessage:null,errorMessage:"Error connecting to the server.",showSuccessWithoutError:!0,retry:{auto:!0,allow:!0},action:a.ajax},c.prototype.hookBackboneAjax=function(b){var c,d=this;if(null==b&&(b={}),null==window.Backbone)throw"Expected Backbone to be defined";return b=f.defaults(b,{id:"BACKBONE_ACTION",errorMessage:!1,successMessage:"Request completed successfully.",showSuccessWithoutError:!1}),c=function(a){var c;return c=f.extend({},b,a.messenger),d["do"](c,a)},null!=Backbone.ajax?(Backbone.ajax._withoutMessenger&&(Backbone.ajax=Backbone.ajax._withoutMessenger),(null==b.action||b.action===this.doDefaults.action)&&(b.action=Backbone.ajax),c._withoutMessenger=Backbone.ajax,Backbone.ajax=c):Backbone.sync=f.wrap(Backbone.sync,function(){var b,d,e;return e=arguments[0],b=2<=arguments.length?n.call(arguments,1):[],d=a.ajax,a.ajax=c,e.call.apply(e,[this].concat(n.call(b))),a.ajax=d})},c.prototype._getHandlerResponse=function(a){return a===!1?!1:a===!0||null==a?!0:a},c.prototype._parseEvents=function(a){var b,c,d,e,f,g,h;null==a&&(a={}),f={};for(e in a)d=a[e],c=e.indexOf(" "),g=e.substring(0,c),b=e.substring(c+1),null==(h=f[g])&&(f[g]={}),f[g][b]=d;return f},c.prototype._normalizeResponse=function(){var a,b,c,d,e,g,h;for(c=1<=arguments.length?n.call(arguments,0):[],d=null,e=null,a=null,g=0,h=c.length;h>g;g++)b=c[g],"success"===b||"timeout"===b||"abort"===b?d=b:null!=(null!=b?b.readyState:void 0)&&null!=(null!=b?b.responseText:void 0)?e=b:f.isObject(b)&&(a=b);return[d,a,e]},c.prototype.run=function(){var b,c,d,e,g,h,i,j,k,l,m,p=this;if(h=arguments[0],k=arguments[1],b=3<=arguments.length?n.call(arguments,2):[],null==k&&(k={}),h=a.extend(!0,{},this.messageDefaults,this.doDefaults,null!=h?h:{}),c=this._parseEvents(h.events),d=function(a,b){var c;return c=h[a+"Message"],f.isFunction(c)?c.call(p,a,b):c},i=null!=(m=h.messageInstance)?m:this.newMessage(h),null!=h.id&&(i.options.id=h.id),null!=h.progressMessage&&i.update(a.extend({},h,{message:d("progress",null),type:"info"})),g={},f.each(["error","success"],function(e){var j;return j=k[e],g[e]=function(){var g,l,m,q,r,s,t,u,v,w,x,y,z,A,B;return s=1<=arguments.length?n.call(arguments,0):[],v=p._normalizeResponse.apply(p,s),r=v[0],g=v[1],u=v[2],"success"===e&&null==i.errorCount&&h.showSuccessWithoutError===!1&&(h.successMessage=null),"error"===e&&(null==(w=h.errorCount)&&(h.errorCount=0),h.errorCount+=1),m=h.returnsPromise?s[0]:"function"==typeof j?j.apply(null,s):void 0,t=p._getHandlerResponse(m),f.isString(t)&&(t={message:t}),"error"!==e||0!==(null!=u?u.status:void 0)&&"abort"!==r?"error"===e&&null!=h.ignoredErrorCodes&&(x=null!=u?u.status:void 0,o.call(h.ignoredErrorCodes,x)>=0)?void i.hide():(l={message:d(e,u),type:e,events:null!=(y=c[e])?y:{},hideOnNavigate:"success"===e},q=a.extend({},h,l,t),"number"==typeof(null!=(z=q.retry)?z.allow:void 0)&&q.retry.allow--,"error"===e&&(null!=u?u.status:void 0)>=500&&(null!=(A=q.retry)?A.allow:void 0)?(null==q.retry.delay&&(q.retry.delay=q.errorCount<4?10:300),q.hideAfter&&(null==(B=q._hideAfter)&&(q._hideAfter=q.hideAfter),q.hideAfter=q._hideAfter+q.retry.delay),q._retryActions=!0,q.actions={retry:{label:"retry now",phrase:"Retrying TIME",auto:q.retry.auto,delay:q.retry.delay,action:function(){return q.messageInstance=i,setTimeout(function(){return p["do"].apply(p,[q,k].concat(n.call(b)))},0)}},cancel:{action:function(){return i.cancel()}}}):q._retryActions&&(delete q.actions.retry,delete q.actions.cancel,delete h._retryActions),i.update(q),t&&q.message?(Messenger(f.extend({},p.options,{instance:p})),i.show()):i.hide()):void i.hide()}}),!h.returnsPromise)for(l in g)e=g[l],j=k[l],k[l]=e;return i._actionInstance=h.action.apply(h,[k].concat(n.call(b))),h.returnsPromise&&i._actionInstance.then(g.success,g.error),i},c.prototype["do"]=c.prototype.run,c.prototype.ajax=function(){var b,c;return c=arguments[0],b=2<=arguments.length?n.call(arguments,1):[],c.action=a.ajax,this.run.apply(this,[c].concat(n.call(b)))},c.prototype.expectPromise=function(a,b){return b=f.extend({},b,{action:a,returnsPromise:!0}),this.run(b)},c.prototype.error=function(a){return null==a&&(a={}),"string"==typeof a&&(a={message:a}),a.type="error",this.post(a)},c.prototype.info=function(a){return null==a&&(a={}),"string"==typeof a&&(a={message:a}),a.type="info",this.post(a)},c.prototype.success=function(a){return null==a&&(a={}),"string"==typeof a&&(a={message:a}),a.type="success",this.post(a)},c}(h),a.fn.messenger=function(){var c,d,e,g,i,j,k,l;return e=arguments[0],d=2<=arguments.length?n.call(arguments,1):[],null==e&&(e={}),c=this,null!=e&&f.isString(e)?(l=c.data("messenger"))[e].apply(l,d):(i=e,null==c.data("messenger")&&(h=null!=(j=null!=(k=Messenger.themes[i.theme])?k.Messenger:void 0)?j:b,c.data("messenger",g=new h(a.extend({el:c},i))),g.render()),c.data("messenger"))},window.Messenger._call=function(b){var c,d,e,f,g,h,i,j,k,l,m;if(h={extraClasses:"messenger-fixed messenger-on-bottom messenger-on-right",theme:"future",maxMessages:9,parentLocations:["body"]},b=a.extend(h,a._messengerDefaults,Messenger.options,b),null!=b.theme&&(b.extraClasses+=" messenger-theme-"+b.theme),i=b.instance||Messenger.instance,null==b.instance){for(k=b.parentLocations,d=null,e=null,l=0,m=k.length;m>l;l++)if(j=k[l],d=a(j),d.length){f=j;break}i?a(i._location).is(a(f))||(i.$el.detach(),d.prepend(i.$el)):(c=a("<ul>"),d.prepend(c),i=c.messenger(b),i._location=f,Messenger.instance=i)}return null!=i._addedClasses&&i.$el.removeClass(i._addedClasses),i.$el.addClass(g=""+i.className+" "+b.extraClasses),i._addedClasses=g,i},a.extend(Messenger,{Message:e,Messenger:b,themes:null!=(k=Messenger.themes)?k:{}}),a.globalMessenger=window.Messenger=Messenger}.call(this),function(){var a,b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a=jQuery,c='<div class="messenger-spinner">\n    <span class="messenger-spinner-side messenger-spinner-side-left">\n        <span class="messenger-spinner-fill"></span>\n    </span>\n    <span class="messenger-spinner-side messenger-spinner-side-right">\n        <span class="messenger-spinner-fill"></span>\n    </span>\n</div>',b=function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return e(d,b),d.prototype.template=function(){var b;return b=d.__super__.template.apply(this,arguments),b.append(a(c)),b},d}(window.Messenger.Message),window.Messenger.themes.future={Message:b}}.call(this);var ModalBox=Class.extend({init:function(a,b){if(this._options={width:"auto",height:"auto",left:"auto",top:"auto",overlay:!0,iconClose:!1,keyClose:!0,bodyClose:!0,iconImg:"img/close.png",onOpen:function(){},onClose:function(){}},b)for(var c in b)this._options[c]=b[c];this._obj=a,this._width=this._obj.width(),this._height=this._obj.height(),this._widthOut=this._obj.outerWidth(),this._heightOut=this._obj.outerHeight(),this._winWidth=$(window).width(),this._winHeight=$(window).height(),this._setWidth=Math.min(this._widthOut,this._winWidth)-(this._widthOut-this._width),this._setHeight=Math.min(this._heightOut,this._winHeight)-(this._heightOut-this._height),this._obj.addClass("iw-modalBox"),this.setOptions()},setOptions:function(){var a=this;"auto"!==a._options.width?a._obj.css("width",a._options.width):a._obj.width(a._setWidth),"auto"!==a._options.height?a._obj.css("height",a._options.height):a._obj.height(a._setHeight);var b="50%",c="50%";if(marginLeft=a._widthOut/2,marginTop=a._heightOut/2,"auto"!==a._options.left&&(c=a._options.left,marginLeft=0),"auto"!==a._options.top&&(b=a._options.top,marginTop=0),this._obj.css({top:b,left:c,position:"fixed",display:"block","margin-left":-marginLeft,"margin-top":-marginTop,"z-index":"99999"}),a._options.overlay&&a.addOverlay(),a._options.iconClose&&a._widthOut<a._winWidth&&a._heightOut<a._winHeight){var d=Math.ceil(1e3*Math.random())+"close",e=$('<img src="'+a._options.iconImg+'" class="iw-closeImg" id="'+d+'"/>');a._obj.attr("closeImg",d),e.bind("click",function(){a.close.call(a)}),$(window).bind("resize.iw-modalBox",{img:e,obj:a._obj},a.resizeEvent),$(window).triggerHandler("resize.iw-modalBox"),$("body").append(e)}if(a._options.keyClose&&a.keyEvent(),a._options.bodyClose){var f=$(".iw-modalOverlay");0===f.length&&(addOverlay(),f=$(".iw-modalOverlay"),f.css({background:"none"})),f.bind("mousedown",function(){a.close.call(a)})}a._options.onOpen.call(this)},close:function(){var a=this;if(a._obj.hasClass("iw-modalBox")){var b=a._obj.attr("closeImg");b&&(a._obj.removeAttr("closeImg"),$("#"+b).remove()),a._obj.css({display:"none"}),a._obj.width(a._width),a._obj.height(a._height),a._options.onClose.call(a),a._obj.removeClass("iw-modalBox"),0===$(".iw-modalBox").length&&($(".iw-modalOverlay").remove(),$(document).unbind("resize.iw-modalBox"))}},keyEvent:function(){var a=this;$(document).keydown(function(b){var c=b.which;27===c&&a.close()})},addOverlay:function(){$("body").append('<div class="iw-modalOverlay"></div>'),$(".iw-modalOverlay").css({display:"block",width:"100%",height:"100%",position:"fixed",top:0,left:0,"z-index":"1000"})},resizeEvent:function(a){var b=a.data.img,c=a.data.obj;b.css({top:c.offset().top-$(window).scrollTop()-8+"px",left:c.offset().left-$(window).scrollTop()+c.width()-8+"px",position:"fixed","z-index":"99999"})}}),Reflection=Class.extend({init:function(a,b){if("undefined"==typeof a||"IMG"!==a.tagName)return void console.log("input img error");if(this._options={height:.5,opacity:.5,hasParentDiv:!1},this._img=$(a),b)for(var c in b)this._options[c]=b[c]},add:function(){var a=this;try{var b=a._img.parent("div");if(a._options.hasParentDiv===!1||"undefined"==typeof b[0]){b=$("<div>",{"class":"reflect"}),a._img[0].parentNode.replaceChild(b[0],a._img[0]),b.append(a._img);for(var c=a._img[0].className.split(" "),d="",e=c.length-1;e>=0;e--)"reflect"!==c[e]&&(d&&(d+=" "),d+=c[e]);d&&b.addClass(d)}else b.hasClass("reflect")||b.addClass("reflect");b[0].style.width=a._img[0].style.width,a._img[0].style.cssText="vertical-align: bottom";var f=Math.floor(a._img.height()*a._options.height),g=a._img.width();if(document.all&&!window.opera){var h=document.createElement("img");h.src=a._img[0].src,h.style.width=a._img.width()+"px",h.style.display="inline-block",h.style.height=f,h.style.marginBottom="-"+(p.height-f)+"px",h.style.filter="flipv progid:DXImageTransform.Microsoft.Alpha(opacity="+100*options.opacity+", style=1, finishOpacity=0, startx=0, starty=0, finishx=0, finishy="+100*options.height+")",b.append(h)}else{var i=document.createElement("canvas");if(i.getContext){var j=i.getContext("2d");i.style.height=f+"px",i.style.width=a._img.width()+"px",i.height=f,i.width=a._img.width(),b[0].style.width=g+"px",b.append(i),j.save(),j.translate(0,a._img.height()-1),j.scale(1,-1),j.drawImage(a._img[0],0,0,a._img.width(),a._img.height()),j.restore(),j.globalCompositeOperation="destination-out";var k=j.createLinearGradient(0,0,0,f);k.addColorStop(1,"rgba(255, 255, 255, 1.0)"),k.addColorStop(0,"rgba(255, 255, 255, "+(1-a._options.opacity)+")"),j.fillStyle=k,j.rect(0,0,g,2*f),j.fill()}}}catch(l){console.log(l)}},remove:function(){var a=this,b=$(a._img[0].parentNode);if(b.removeClass("reflect"),document.all&&!window.opera){var c=b.children("div");c.style.cssText="","undefined"!=typeof c[1]&&c[1].remove()}else{var d=b.children("canvas");"undefined"!=typeof d&&d.remove()}}}),Tab=Class.extend({init:function(a,b,c,d){if(!a||!b)return void console.log("id and json can't be null");this._top="0px",this._left="0px",this._width="100%",this._height="100%",c&&(this._top=c.top,this._left=c.left),d&&(this._width=d._width,this._height=d._height),this._tabShow=$("<div>",{"class":"tab-show"}),this._tabDiv=$("<div>",{"class":"tab-div"}),this._tabShow.append(this._tabDiv);for(var e=0;e<b.length;e++){var a="tab-"+Math.ceil(1e5*Math.random()),f=$("<div>",{"class":"tab-content",id:a});this._tabShow.append(f),f.hide();var g="<a tab='#"+a+"'>"+b[e]+"</a>";this._tabDiv.append(g)}this.bindEvent()},addDivByTab:function(a,b){for(var c=this._tabShow.children(".tab-content"),d=this._tabDiv.children("a"),e=0;e<d.length;e++)if(d[e].textContent===b){var f=$(c[e]);f.append(a)}},setShowByTab:function(a){for(var b=this._tabShow.children(".tab-content"),c=this._tabDiv.children("a"),d=0;d<c.length;d++)c[d].textContent===a?($(c[d]).addClass("selected"),$(b[d]).show()):$(b[d]).hide()},injectParent:function(a){a.append(this._tabShow)},bindEvent:function(){var a=this;$(function(){var b=$(a._tabDiv.children("a"));b.each(function(){$($(this).attr("tab")).slideUp(),$(this).hasClass("selected")&&$($(this).attr("tab")).slideDown(),$(this).mousedown(function(a){a.preventDefault(),a.stopPropagation(),$(this).hasClass("selected")||(b.each(function(){$(this).removeClass("selected"),$($(this).attr("tab")).slideUp(500)}),$(this).addClass("selected"),$($(this).attr("tab")).slideDown(500))})})})}}),Tooltip=Class.extend({init:function(a,b){return"undefined"==typeof a?void console.log("argument err!!"):(this._title="",this._tooltip=null,this._pos="undefined"==typeof b?"cursor":b,this._top=null,this._left=null,this._target=void 0,void this.bindTarget(a))},calPosition:function(a){var b=this,c=$(a.target).width(),d=$(a.target).height(),e=$("#title-inner").width(),f=$("#title-inner").height(),g=$(a.target).offset().left,h=$(a.target).offset().top;switch(b._pos){case"top":b._top=h-f-5,b._left=g+(c-e)/2-5;break;case"bottom":b._top=h+d-5,b._left=g+(c-e)/2-5;break;case"left":b._top=h+(d-f)/2-5,b._left=g-e-5;break;case"right":b._top=h+(d-f)/2-5,b._left=g+c-5;break;default:b._top=h+a.offsetY+10,b._left=g+a.offsetX+10}$(".tooltip").css({top:b._top+"px",left:b._left+"px"})},setPosition:function(a){this._pos=a},getTitle:function(){return this._title},mouseOver:function(a){""!==a.target.title&&(this._title=a.target.title,this._target=a.target,a.target.title="",this._tooltip="<div class='tooltip'><div id='title-inner' class='tipsy-inner'>"+this._title+"</div></div>",$("body").append(this._tooltip),this.calPosition(a),$(".tooltip").show("fast"))},mouseOut:function(){""!==this._title&&("undefined"!=typeof this._target&&(this._target.title=this._title,this._title=""),$(".tooltip").remove(),this._target=void 0)},mouseMove:function(a){this.calPosition(a)},bindTarget:function(a){var b=this;a.mouseover(function(a){b.mouseOver(a)}),a.mouseout(function(){b.mouseOut()}),a.mousemove(function(a){b.mouseMove(a)})}}),Unslider=Class.extend({init:function(a,b){if(this._obj=a,this._options={speed:!1,delay:3e3,complete:!1,keys:!0,dots:!1,fluid:!1},this._sizes=[],this._max=[this._obj.outerWidth(),this._obj.outerHeight()],this._current=0,this._interval=!1,b)for(var c in b)this._options[c]=b[c];this._ul=this._obj.children("ul"),this._items=this._ul.children("li"),this.calculate(),this.setup()},calculate:function(){for(var a=this,b=0;b<a._items.length;b++){var c=$(a._items[b]).outerWidth(),d=$(a._items[b]).outerHeight();a._sizes[b]=[c,d],c>a._max[0]&&(a._max[0]=c),d>a._max[1]&&(a._max[1]=d)}},setup:function(){var a=this;if(this._obj.css({overflow:"hidden",width:"100%",height:"100%"}),a._ul.css({width:100*a._items.length+"%",height:"100%",position:"relative"}),a._items.css({width:100/a._items.length+"%",height:"100%"}),this._options.delay!==!1&&(a.start(),a._obj.hover(a.stop,a.start)),a._options.keys&&a.keys(),a._options.dots&&a.dots(),this._options.fluid){var b=function(){a._obj.css("width",Math.min(Math.round(a._obj.outerWidth()/a._obj.parent().outerWidth()*100),100)+"%")};b(),$(window).resize(b)}window.jQuery.event.swipe&&a._obj.on("swipeleft",a.prev).on("swiperight",a.next)},move:function(a,b){var c=this;c._items.eq(a).length||(a=0),0>a&&(a=c._items.length-1);var d=(c._items.eq(a),{height:"100%"}),e=b?5:c._options.speed;this._ul.is(":animated")||(c._obj.find(".dot:eq("+a+")").addClass("active").siblings().removeClass("active"),c._obj.animate(d,e),c._ul.animate({left:"-"+a+"00%",height:"100%"},e,function(){c._current=a}))},start:function(){var a=this;a._interval=setInterval(function(){a.move(a._current+1)},a._options.delay)},stop:function(){var a=this;a._interval=clearInterval(a._interval)},keys:function(){var a=this;$(document).keydown(function(b){var c=b.which;switch(c){case 39:a.next();break;case 37:a.prev();break;case 27:a.stop()}})},next:function(){var a=this;a.stop(),a.move(a._current+1)},prev:function(){var a=this;a.stop(),a.move(a._current-1)},dots:function(){for(var a=this,b='<ol class="dots">',c=0;c<a._items.length;c++)b+='<li class="dot'+(1>c?" active":"")+'">'+(c+1)+"</li>";b+="</ol>",a._obj.addClass("has-dots").append(b).find(".dot").click(function(){a.move($(this).index())})}}),Video=Class.extend({init:function(a){if(this._sections={controls:!0,width:"100%",height:"90%",src:"",contextMenu:!0},a)for(var b in a)this._sections[b]=a[b];this._section=$("<section id='player'></section>"),this._video=$("<video width='"+this._sections.width+"' height='"+this._sections.height+"' controls></video>"),this._section.append(this._video),this._ctxMenu=ContextMenu.create(),this._source=$("<source src=''></source>"),this._video.append(this._source),this._video.append($("<p>The browser doesn't support html5</p>")),this._sections.controls&&(this._video[0].style.cssText="controls='controls'"),""!==this._sections.src&&this.setSrc(this._sections.src),this._sections.contextMenu&&this.setContextMenu()},setSrc:function(a){this._source[0].src=a},injectParent:function(a){a.append(this._section)},setMenu:function(a){var b=a;b._video[0].paused?(b._ctxMenu.activeItem("video","Play",function(){b._video[0].paused&&b._video[0].play()}),b._ctxMenu.disableItem("video","Pause")):(b._ctxMenu.disableItem("video","Play"),b._ctxMenu.activeItem("video","Pause",function(){b._video[0].pause()})),b._video[0].loop?(b._ctxMenu.activeItem("video","Order play",function(){b._video[0].loop=!1}),b._ctxMenu.disableItem("video","Loop play")):(b._ctxMenu.activeItem("video","Loop play",function(){b._video[0].loop=!0}),b._ctxMenu.disableItem("video","Order play")),b._video[0].fullScreen?b._ctxMenu.disableItem("video","Full screen"):b._ctxMenu.activeItem("video","Full screen",function(){"undefined"!=typeof b._video[0].mozRequestFullScreen&&b._video[0].mozRequestFullScreen(),"undefined"!=typeof b._video[0].webkitRequestFullScreen&&b._video[0].webkitRequestFullScreen(),"undefined"!=typeof b._video[0].requestFullscreen&&b._video[0].requestFullscreen()})},setContextMenu:function(){var a=this;this._ctxMenu.addCtxMenu([{header:"video"},{text:"Play",icon:"icon-play",action:function(){a._video[0].paused&&a._video[0].play()}},{text:"Pause",icon:"icon-pause",action:function(){a._video[0].pause()}},{text:"Loop play",icon:"icon-repeat",action:function(){a._video[0].loop=!0}},{text:"Order play",icon:"icon-reorder",action:function(){a._video[0].loop=!1}},{text:"Full screen",icon:"icon-fullscreen",action:function(){}}]),a._ctxMenu.attachToMenu("video",a._ctxMenu.getMenuByHeader("video"),function(){a.setMenu(a)})}}),Window=Class.extend({init:function(a,b,c,d){if(this._options={animate:!0,contentDiv:!0,hide:!0,min:!1,max:!0,close:!0,fadeSpeed:100,hideWindow:!1,width:600,height:600,left:0,top:0,contentDiv:!0,iframe:!1,maxWindow:!1,resize:!1,minWidth:200,minHeight:200,fullScreen:!1},c)for(var e in c)this._options[e]=c[e];this._isMouseOnTitleDown=!1,this._isMouseResizeDown=!1,this._ishideDiv=!1,this._offsetX=0,this._offsetY=0,this._title=b,this._id=a,this._isMax=!1,this._fullScreen=!1,this._saveWindowCss="",this._saveWinContentCss="",this._focusCallback=void 0,this._INDEX=100,this._window=$("<div>",{id:this._id,"class":"window"}),this._titleDiv=$("<div>",{"class":"window-top"}),this._window.append(this._titleDiv),this._titleText='<div class="window-title">'+this._title+"</div>",this._titleDiv.append(this._titleText),this._titleText=$(this._titleDiv.children(".window-title")[0]),this._titleButton=$("<div>",{"class":"window-title-button"}),this._titleDiv.append(this._titleButton),this._options.contentDiv?(this._windowContent=$("<div>",{"class":"window-content"}),this._window.append(this._windowContent)):this._options.iframe&&(this._windowContent=$("<iframe>",{"class":"window-content"}),this._window.append(this._windowContent)),1==this._options.resize&&(this._dragDiv=$("<div>",{"class":"rb-drag-div"}),this._window.append(this._dragDiv)),$("body").append(this._window),this.setOptions(),this._options.hideWindow===!1?this.show():this.hide(),this._options.maxWindow&&this.maxWindow(this),this.bindEvent(),d&&d.call(this)},setOptions:function(){var a=this;for(var b in a._options)switch(b){case"close":1==a._options[b]&&(a._titleButton.append("<a id='window-"+a._id+"-close' class='window-button-close' href='#'><i class='icon-remove'></i></a>"),a.bindButton($(a._titleButton.children(".window-button-close")[0]),a.closeWindow,a),$(".window-button-"+b).addClass("active"));break;case"max":1==a._options[b]&&(a._titleButton.append("<a id='window-"+a._id+"-max' class='window-button-max' href='#'><i class='icon-resize-full'></i></a>"),a.bindButton($(a._titleButton.children(".window-button-max")[0]),a.maxWindow,a),$(".window-button-"+b).addClass("active"));break;case"min":1==a._options[b]&&(a._titleButton.append("<a id='window-"+a._id+"-min' class='window-button-min' href='#'><i class='icon-minus'></i></a>"),$(".window-button-"+b).addClass("active"));break;case"hide":1==a._options[b]&&(a._titleButton.append("<a id='window-"+a._id+"-hide' class='window-button-hide' href='#'><i class='icon-double-angle-up'></i></a>"),a.bindButton($(a._titleButton.children(".window-button-hide")[0]),a.hideDiv,a),$(".window-button-"+b).addClass("active"))}this.setWindowPos(this._options),this.resizeWindow(this._options)},bindButton:function(a,b,c){a.mousedown(function(a){a.preventDefault(),a.stopPropagation()}).mouseup(function(a){b(c),a.stopPropagation()}).click(function(a){a.preventDefault(),a.stopPropagation()})},bindCloseButton:function(a,b){this._options.close&&this.bindButton(this._titleButton.children(".window-button-close"),a,b)},bindMinButton:function(a,b){this._options.min&&this.bindButton(this._titleButton.children(".window-button-min"),a,b)},bindMaxButton:function(a,b){this._options.max&&this.bindButton(this._titleButton.children(".window-button-max"),a,b)
},bindHideButton:function(a,b){this._options.hide&&this.bindButton(this._titleButton.children(".window-button-hide"),a,b)},gitID:function(){return this._id},focus:function(){this._window.css("z-index",this._INDEX+1)},blur:function(){this._window.css("z-index",this._INDEX)},onfocus:function(a){a&&(this._focusCallback=a)},changeIcon:function(a,b,c,d){var e=$(this._titleButton.children("."+a)[0]),f=$(e.children("."+b)[0]);f.removeClass(b),f.addClass(c),e.unbind(),this.bindButton(e,d,this)},bindEvent:function(){var a=this;$(document).on("contextmenu","#"+a._window[0].id,function(a){a.stopPropagation(),a.preventDefault()}),this._titleDiv.mousedown(function(b){b.preventDefault(),a._isMax||(a._isMouseOnTitleDown=!0,a._offsetX=b.clientX-a._window.position().left,a._offsetY=b.clientY-a._window.position().top,a._window.fadeTo(20,.8))}).mouseup(function(){a._isMouseOnTitleDown=!1,a._window.fadeTo(20,1)}).dblclick(function(){a.toggleMaxWindow()}),"undefined"!=typeof this._dragDiv&&this._dragDiv.mousedown(function(){a._isMax||a._ishideDiv||!a._options.resize||(a._isMouseResizeDown=!0,a._window.fadeTo(20,.9))}).mouseup(function(){a._isMouseResizeDown&&(a._isMouseResizeDown=!1,a._options.width=a._window.width(),a._options.height=a._window.height(),a._window.fadeTo(20,1))}),$(document).mousemove(function(b){if(a._isMouseOnTitleDown){var c=b.clientX-a._offsetX,d=b.clientY-a._offsetY;a.setWindowPos({left:c,top:d}),a._options.top=d,a._options.left=c,a._titleDiv.css("cursor","move")}else if(a._isMouseResizeDown&&a._options.resize){var e=b.clientX-a._window.position().left+5,f=b.clientY-a._window.position().top+5;e<a._options.minWidth&&(e=a._options.minWidth),f<a._options.minHeight&&(f=a._options.minHeight),a._options.width=e,a._options.height=f,a.resizeWindow(a._options),a._dragDiv.css("cursor","se-resie")}}),a._options.fullscreen&&a._windowContent.dblclick(function(b){a.togglefullScreen(),b.stopPropagation(),b.preventDefault()}),a._window.mousedown(function(b){a.focus(),a._focusCallback&&a._focusCallback.call(a),b.stopPropagation()}).mouseup(function(a){a.stopPropagation()})},resizeWindow:function(a){var b=this,c=a.width-2;b._titleDiv.css({width:c+"px"}),c=a.width-130,b._titleText.css({width:c+"px"}),c=a.width-10;var d=a.height-50;"undefined"!=typeof b._windowContent&&b._windowContent.css({width:c+"px",height:d+"px"})},resizeWindowWithAnimate:function(a,b){var c=this;c._window.animate({left:b.left+"px",top:b.top+"px"},c._options.fadeSpeed);var d=a.width-2;c._titleDiv.animate({width:d+"px"},c._options.fadeSpeed),d=a.width-130,c._titleText.animate({width:d+"px"},c._options.fadeSpeed),d=a.width-10;var e=a.height-50;"undefined"!=typeof c._windowContent&&c._windowContent.animate({width:d+"px",height:e+"px"},c._options.fadeSpeed)},maxWindow:function(a){var b=a,c=document.body.clientWidth,d=document.body.clientHeight,e=($("#dock").attr("bottom"),{left:0,top:0}),f={width:c,height:d};b._options.animate?b.resizeWindowWithAnimate(f,e):(b.setWindowPos(e),b.resizeWindow(f)),b._isMax=!0,b._isMouseResizeDown=!1,b._window.fadeTo(20,1),b.changeIcon("window-button-max","icon-resize-full","icon-resize-small",b.recoverWindow)},recoverWindow:function(a){var b=a,c={left:b._options.left,top:b._options.top},d={width:b._options.width,height:b._options.height};b._options.animate?b.resizeWindowWithAnimate(d,c):(b.setWindowPos(c),b.resizeWindow(d)),b._isMax=!1,b.changeIcon("window-button-max","icon-resize-small","icon-resize-full",b.maxWindow)},toggleMaxWindow:function(){this._isMax?this.recoverWindow(this):this.maxWindow(this)},closeWindow:function(a){var b=a;b._options.animate?b._window.fadeOut(b._options.fadeSpeed,function(){b._window.remove()}):b._window.remove()},hideDiv:function(a){var b=a;"undefined"!=typeof b._windowContent&&(b._options.animate?b._windowContent.slideUp(b._options.fadeSpeed):b._windowContent.hide()),console.log("hide window"),b._ishideDiv=!0,b._isMouseResizeDown=!1,b.changeIcon("window-button-hide","icon-double-angle-up","icon-double-angle-down",b.showDiv)},showDiv:function(a){var b=a;b._ishide=!1,"undefined"!=typeof b._windowContent&&(b._options.animate?b._windowContent.slideDown(b._options.fadeSpeed):b._windowContent.show()),b._ishideDiv=!1,b.changeIcon("window-button-hide","icon-double-angle-down","icon-double-angle-up",b.hideDiv)},setWindowPos:function(a){this._window.css("left",a.left+"px"),this._window.css("top",a.top+"px")},show:function(){this._options.animate?this._window.fadeIn(this._options.fadeSpeed):this._window.show()},append:function(a){a&&this._windowContent.append(a)},close:function(){var a=this;"undefined"!=typeof this._window&&this.closeWindow(a)},hide:function(){this._options.animate?this._window.fadeOut(this._options.fadeSpeed):this._window.hide()},appendHtml:function(a){function b(){c._windowContent.contents().find("body")[0].onclick=function(){c.focus(),c._options._focusCallback&&c._options._focusCallback.call(c)}}var c=this;return this._options.iframe?(this._windowContent[0].onload=function(){b()},void(this._windowContent[0].src=a)):0},fullScreen:function(a){"undefined"==typeof a&&(a=!0),a?this._titleDiv.hide():this._titleDiv.show(),a!==this._fullScreen&&(this._fullScreen=a,a?(this._saveWinContentCss=this._windowContent[0].style.cssText,this._windowContent[0].style.cssText="margin: 0;"):(this._windowContent[0].style.cssText=this._saveWinContentCss,this._saveWinContentCss=""),a?(this._saveWindowCss=this._window[0].style.cssText,this._window[0].style.cssText="left: 0px; top: 0px; display: block;"):(this._window[0].style.cssText=this._saveWindowCss,this._saveWindowCss=""),this._windowContent[a?"addClass":"removeClass"]("fullwindow"),this._window[a?"addClass":"removeClass"]("fullwindow"))},togglefullScreen:function(){this.fullScreen(!this._fullScreen)}});