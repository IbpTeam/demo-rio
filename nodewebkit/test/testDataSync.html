<html>
<head>
<title>test</title>
  <script src="../lib/require.js"></script>
  <script src="../lib/jquery.js"></script>
  <script src="../lib/api.js"></script>

</head>
<meta charset="UTF-8">

<body>
<div id="onLine"></div>
<br>
<div id="deviceUp"></div>
<br>
<div id="deviceDown"></div>

<script>
var onLine = [];
var htmlUp = [];
var htmlDown = [];
onLine.push("<h2>OnLine:</h2>");
htmlUp.push("<h2>Device Up:</h2>");
htmlDown.push("<h2>Device Down:</h2>");
function deviceUpCb(data){
  if(data.txtRecord!=null){
    console.log("device up : "+data.txtRecord.account+" on "+data.txtRecord.deviceName);
    onLine.push("<li>deviceName: " + data.name);
    htmlUp.push("<li>deviceName: " + data.txtRecord.deviceName);
    document.getElementById('deviceUp').innerHTML = htmlUp.join("");
    document.getElementById('onLine').innerHTML = onLine.join(""); 
  }
  //demoDataSync(data.txtRecord.deviceName); 
}


function deviceDownCb(data){
    console.log("device down : "+data.name);
    htmlDown.push("<li>deviceName: " + data.name);
    document.getElementById('deviceDown').innerHTML = htmlDown.join("");
    for (var i = onLine.length - 1; i >= 0; i--) {
      //console.log("++++++++++++"+onLine[i]);
      if (onLine[i] == ("<li>deviceName: " + data.name)) {
      	onLine.splice(i,1);
      }
    }
    document.getElementById('onLine').innerHTML = onLine.join("");
}

WDC.requireAPI(['data'], function(data){
    console.log("test getDeviceDiscoveryService");
    //调用函数，返回一个数组,r[0]是浏览器名称，r[1]是版本号
    data.getDeviceDiscoveryService(deviceUpCb,deviceDownCb);
  });
</script>


</body>
</html>
